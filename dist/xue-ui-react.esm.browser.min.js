/*!
  * xue-ui-react v1.0.0
  * (c) 2020 Huaihuan Xue
  * @license MIT
  */
/*!
  * xue-ui-react v1.0.0
  * (c) 2020 Huaihuan Xue
  * @license MIT
  */
import e,{Component as t}from"react";import o from"prop-types";import i from"styled-components";function r(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}const n={centerMode:!1,fgcolor:"",size:"md"},s={centerMode:o.bool,fgcolor:o.string,size:o.string},c=(l="Number",function(e){return Object.prototype.toString.call(e).slice(8,-1)===""+l});var l;const a=e=>{const t=document.documentElement||document.body.parentNode;return function(){return c(t[e])?t[e]:document.body[e]}},p=a("scrollTop"),h=a("scrollLeft"),d=i.div.attrs(()=>({className:"ripple"}))`
  display: inline-block;
  position: relative;

  .${"ripple-list"} {
    overflow: hidden;
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    pointer-events: none;
    ${e=>e.fgcolor?`color: ${e.fgcolor};`:""}
  }
`,u=i.div.attrs(()=>({className:"ripple-item"}))`
  position: absolute;
  left: 0;
  top: 0;
  border-radius: 50%;
  ${e=>e.fgcolor?`background-color: ${e.fgcolor};`:"background-color: currentcolor;"}
  opacity: 0.5;
  transform: scale(0);
  will-change: height, transform, width;

  &.${"ripple-effect"} {
    animation: ${"ripple-effect"} 1000ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  @keyframes ${"ripple-effect"} {
    100% {
      transform: scale(1);
      opacity: 0;
    }
  }
`,m=["xxs","xs","sm","md","lg","xl","xxl"];class f extends t{constructor(e){super(e),r(this,"getUuid",()=>`ripple-item-${this.now}-${this.seed++}`),r(this,"getRef",e=>{this.rippleNode=e}),r(this,"ripple",(e,t)=>{const o=this.getPoint(e),{centerMode:i,size:r}=this.props,n=p(),s=h(),c=o.clientX||o.pageX-s,l=o.clientY||o.pageY-n,a=this.rippleNode.parentNode,{offsetWidth:d,offsetHeight:u}=a,f=Math.max(d,u),g=a.getBoundingClientRect();let b=0,v=0;const x=(e=>{let t;switch(e=e&&m.includes(e)?e:"md"){case"xxs":t=.5;break;case"xs":t=.75;break;case"sm":t=1;break;case"md":t=2;break;case"lg":t=3;break;case"xl":t=4;break;case"xxl":default:t=5}return t})(r);i?(b=(d-f*x)/2,v=(u-f*x)/2):(b=c-g.left-f*x/2,v=l-g.top-f*x/2),function(e,t){for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e.style[o]=t[o])}(t,{width:f*x+"px",height:f*x+"px",top:v+"px",left:b+"px"}),function(e,t){const o=t.split(/\s+/);for(const t of o)e.classList.add(t)}(t,"ripple-effect")}),r(this,"handleTouchStart",e=>{const t=[...this.state.children];t.push(this.getUuid()),this.setState(()=>({children:t}),()=>{const o=t.length-1,i=this.rippleNode.querySelectorAll(".ripple-item");i[o]&&this.ripple(e,i[o])})}),r(this,"handleAnimationEnd",e=>{const t=this.state.children.filter(t=>e!==t);this.setState({children:t})}),this.touchEvent=(()=>{let e;return e="ontouchstart"in document?{touchstart:"touchstart",touchmove:"touchmove",touchend:"touchend",mobile:!0}:{touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",mobile:!1},e})(),this.now=Date.now()||+new Date,this.seed=0,this.state={children:[]}}componentDidMount(){this.rippleNode&&this.rippleNode.parentNode.addEventListener(this.touchEvent.touchstart,this.handleTouchStart)}componentWillUnmount(){this.rippleNode&&this.rippleNode.parentNode.removeEventListener(this.touchEvent.touchstart,this.handleTouchStart),this.rippleNode=null,this.touchEvent=null}getPoint(e){return e=e||window.event,this.touchEvent.mobile?e.changedTouches[0]:e}render(){const{children:t,centerMode:o,...i}=this.props;return e.createElement(d,i,e.createElement("div",{className:"ripple-list",ref:this.getRef},this.state.children.map(t=>e.createElement(u,{key:t,onAnimationEnd:()=>this.handleAnimationEnd(t)}))),t)}}f.defaultProps=n,f.propTypes=s;export{f as Ripple};