/*!
  * xue-ui-react v1.0.0
  * (c) 2020 Huaihuan Xue
  * @license MIT
  */
/*!
  * xue-ui-react v1.0.0
  * (c) 2020 Huaihuan Xue
  * @license MIT
  */
import t,{Component as e}from"react";import o from"styled-components";const i=(s="Number",function(t){return Object.prototype.toString.call(t).slice(8,-1)===""+s});var s;const n=t=>{const e=document.documentElement||document.body.parentNode;return function(){return i(e[t])?e[t]:document.body[t]}},r=n("scrollTop"),c=n("scrollLeft"),l=o.div.attrs(()=>({className:"ripple"}))`
  display: inline-block;
  position: relative;

  .${"ripple-list"} {
    overflow: hidden;
    position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    pointer-events: none;
    ${t=>t.fgcolor?`color: ${t.fgcolor};`:""}
  }
`,a=o.div.attrs(()=>({className:"ripple-item"}))`
  position: absolute;
  left: 0;
  top: 0;
  border-radius: 50%;
  ${t=>t.fgcolor?`background-color: ${t.fgcolor};`:"background-color: currentcolor;"}
  opacity: 0.5;
  transform: scale(0);
  will-change: height, transform, width;

  &.${"ripple-effect"} {
    animation: ${"ripple-effect"} 1000ms cubic-bezier(0.4, 0, 0.2, 1);
  }

  @keyframes ${"ripple-effect"} {
    100% {
      transform: scale(1);
      opacity: 0;
    }
  }
`,h=["xxs","xs","sm","md","lg","xl","xxl"];class p extends e{constructor(t){super(t),this.now=Date.now()||+new Date,this.seed=0,this.state={children:[]},this.getUuid=()=>`ripple-item-${this.now}-${this.seed++}`,this.getRef=t=>{this.rippleNode=t},this.ripple=(t,e)=>{const o=this.getPoint(t),{centerMode:i,size:s}=this.props,n=r(),l=c(),a=o.clientX||o.pageX-l,p=o.clientY||o.pageY-n,d=this.rippleNode.parentNode,{offsetWidth:u,offsetHeight:m}=d,f=Math.max(u,m),g=d.getBoundingClientRect();let b=0,v=0;const x=(t=>{let e;switch(t=t&&h.includes(t)?t:"md"){case"xxs":e=.5;break;case"xs":e=.75;break;case"sm":e=1;break;case"md":e=2;break;case"lg":e=3;break;case"xl":e=4;break;case"xxl":default:e=5}return e})(s);i?(b=(u-f*x)/2,v=(m-f*x)/2):(b=a-g.left-f*x/2,v=p-g.top-f*x/2);!function(t,e){for(const o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t.style[o]=e[o])}(e,{width:f*x+"px",height:f*x+"px",top:v+"px",left:b+"px"}),function(t,e){const o=e.split(/\s+/);for(const e of o)t.classList.add(e)}(e,"ripple-effect")},this.handleTouchStart=t=>{const e=[...this.state.children];e.push(this.getUuid()),this.setState(()=>({children:e}),()=>{const o=e.length-1,i=this.rippleNode.querySelectorAll(".ripple-item");i[o]&&this.ripple(t,i[o])})},this.handleAnimationEnd=t=>{const e=this.state.children.filter(e=>t!==e);this.setState({children:e})},this.touchEvent=(()=>{let t;return t="ontouchstart"in document?{touchstart:"touchstart",touchmove:"touchmove",touchend:"touchend",mobile:!0}:{touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",mobile:!1},t})()}componentDidMount(){this.rippleNode&&this.rippleNode.parentNode.addEventListener(this.touchEvent.touchstart,this.handleTouchStart)}componentWillUnmount(){this.rippleNode&&this.rippleNode.parentNode.removeEventListener(this.touchEvent.touchstart,this.handleTouchStart),this.rippleNode=null,this.touchEvent=null}getPoint(t){return t=t||window.event,this.touchEvent.mobile?t.changedTouches[0]:t}render(){const{children:e,centerMode:o,...i}=this.props;return t.createElement(l,Object.assign({},i),t.createElement("div",{className:"ripple-list",ref:this.getRef},this.state.children.map(e=>t.createElement(a,{key:e,onAnimationEnd:()=>this.handleAnimationEnd(e)}))),e)}}p.defaultProps={centerMode:!1,fgcolor:"",size:"md"};export{p as Ripple};